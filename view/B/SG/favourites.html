<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <title>Favorites</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-QWTKZyjpPEjISv5WaRU9OFeRpok6YctnYmDr5pNlyT2bRjXh0JMhjY6hW+ALEwIH" crossorigin="anonymous">
    <style>
        .favorites-item {
            border: 1px solid #ccc;
            margin: 10px;
            padding: 10px;
        }

        .remove-btn {
            margin-top: 10px;
            cursor: pointer;
            background-color: #cc3b33;
            color: white;
            border: none;
            padding: 10px 20px;
            display: none;
        }

        .remove-btn:hover {
            background-color: #d14f47;
        }

        .remove-all-btn {
            margin-top: 10px;
            cursor: pointer;
            background-color: #cc3b33;
            color: white;
            border: none;
            padding: 10px 20px;
            display: none;
        }

        .remove-all-btn:hover {
            background-color: #d14f47;
        }
        
        .price {
            font-weight: bold;
            margin: 10px 0;
        }
        
        .favorite-img {
            max-height: 200px;
            object-fit: contain;
        }
        
        #favoriteNotification {
            position: fixed;
            bottom: 20px;
            right: 20px;
            padding: 15px 20px;
            background-color: #333;
            color: white;
            border-radius: 4px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.2);
            z-index: 1000;
        }
    </style>
    <script src="../checkCountry.js"></script>
    <script src="../../header.js"></script>
</head>

<body>
    <script src="menu2.js"></script>
    <div role="main" class="main">
        <section class="page-top">
            <div class="container">
                <div class="row">
                    <div class="col-md-12">
                        <h2>Favorites</h2>
                    </div>
                </div>
            </div>
        </section>
        <div class="container">
            <div id="favoritesContainer" class="row">
                <!-- Favorite items will be dynamically added here -->
            </div>
            <button class="remove-all-btn btn" onclick="removeAllFavorites()">Remove All Favorites</button>
        </div>
        <script src="../footer.js"></script>
    </div>

    <script>
        function loadFavorites() {
            const favoritesContainer = document.getElementById('favoritesContainer');
            const favoriteItems = JSON.parse(sessionStorage.getItem('favorites')) || [];

            if (favoriteItems.length === 0) {
                favoritesContainer.innerHTML = '<p>No items in favorites.</p>';
                document.querySelector('.remove-all-btn').style.display = 'none'; 
                return;
            }

            favoritesContainer.innerHTML = '';

            favoriteItems.forEach(item => {
                const itemElement = document.createElement('div');
                itemElement.className = 'col-md-4 favorites-item';
                itemElement.innerHTML = `
                    <h3>${item.name}</h3>
                    <img src="${item.imageURL}" alt="${item.name}" class="img-fluid favorite-img">
                    <div class="price">$${item.price}</div>
                    <p>${item.category}</p>
                    <button class="remove-btn btn" onclick="removeFromFavorites(${item.id})">Remove from Favorites</button>
                `;
                favoritesContainer.appendChild(itemElement);
            });

            document.querySelectorAll('.remove-btn').forEach(btn => {
                btn.style.display = 'block';
            });
            document.querySelector('.remove-all-btn').style.display = 'block';
        }

        function removeFromFavorites(id) {
            let favoriteItems = JSON.parse(sessionStorage.getItem('favorites')) || [];
            
            // Convert both IDs to numbers for proper comparison
            favoriteItems = favoriteItems.filter(item => Number(item.id) !== Number(id));
            
            sessionStorage.setItem('favorites', JSON.stringify(favoriteItems));
            loadFavorites();
            showNotification('Item removed from favorites');
        }

        function removeAllFavorites() {
            sessionStorage.removeItem('favorites');
            document.getElementById('favoritesContainer').innerHTML = '<p>No items in favorites.</p>';
            document.querySelector('.remove-all-btn').style.display = 'none';
            showNotification('All items removed from favorites');
        }

        function showNotification(message) {
            // Remove existing notification if any
            const existingNotification = document.getElementById("favoriteNotification");
            if (existingNotification) {
                existingNotification.remove();
            }
            
            const notification = document.createElement('div');
            notification.id = "favoriteNotification";
            notification.textContent = message;
            
            document.body.appendChild(notification);
            
            // Auto-remove after 3 seconds
            setTimeout(() => {
                notification.style.transition = "opacity 0.5s";
                notification.style.opacity = "0";
                setTimeout(() => {
                    notification.remove();
                }, 500);
            }, 3000);
        }

        window.onload = loadFavorites;
    </script>
</body>

</html>
